<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { (function(){function e(g){this.t={};this.tick=function(h,k,f){this.t[h]=[void 0!=f?f:(new Date).getTime(),k];if(void 0==f)try{window.console.timeStamp("CSI/"+h)}catch(m){}};this.tick("start",null,g)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var l=0<d?new e(d):new e;window.jstiming={Timer:e,load:l};if(a){var b=a.navigationStart;0<b&&d>=b&&(window.jstiming.srt=d-b)}if(a){var c=window.jstiming.load;0<b&&d>=b&&(c.tick("_wtsrt",void 0,b),c.tick("wtsrt_","_wtsrt",
d),c.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),c&&0<b&&(c.tick("_tbnd",void 0,window.chrome.csi().startE),c.tick("tbnd_","_tbnd",b))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,c&&0<b&&(c.tick("_tbnd",void 0,window.external.startE),c.tick("tbnd_","_tbnd",b))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script>
<link rel="shortcut icon" type="image/x-icon" href="//www.google.com/images/icons/product/sites-16.ico" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/4edc19/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/site/libby8dev/fignition","deleted":false,"title":"fignition","dir":"ltr"},{"path":"/site/libby8dev/fignition/documentation","deleted":false,"title":"Documentation","dir":"ltr"},{"path":"/site/libby8dev/fignition/documentation/understand-it","deleted":false,"title":"Understand It","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/4edc19/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":true,"pageSharingId":"jotspot_page","codeembeds":{"outerIframeSrc":"https://www.gstatic.com/jotspot/embeds/code/0f08d42392f2000e7e3f3daf5b427a43/outer_iframe.html","innerIframeSrc":"https://1698231568-jotspot-embeds.googleusercontent.com/code/8d87fa64604b2a11fae2ed06104c58d3/inner_iframe.html"},"enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"Libby8dev","jot2atari":{"eligibility":"ineligible"},"onepickUrl":"https://docs.google.com/picker","adsensePublisherId":null,"features":{"oAuthForChartsApi":true,"moreMobileStyleImprovements":null,"googleChartsOverGstatic":false,"picasaAlbumInsert":false,"subscriptionDataMigrationInProgress":false,"enableJot2Atari":true,"plusBadge":false},"isPublic":true,"newSitesBaseUrl":"https://sites.google.com","isConsumer":true,"serverFlags":{"jot2AtariLearnMoreUrl":"https://support.google.com/sites/answer/7035197"},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://accounts.google.com/AccountChooser?continue\u003dhttps://sites.google.com/site/libby8dev/fignition/documentation/understand-it\u0026service\u003djotspot","analyticsAccountId":"UA-10916122-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/4edc19/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/4edc19/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/4edc19/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/4edc19/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/4edc19/system/app/css/trogedit.css","/site/libby8dev/_/rsrc/1560928646000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/4edc19/system/app/css/codeeditor.css","/site/libby8dev/_/rsrc/1560928646000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"/site/libby8dev","name":"libby8dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":false,"isPageDraft":null,"parentPath":"/fignition/documentation","parentWuid":"wuid:gx:7c694f1034e72915","siteLocale":"en_GB","timeZone":"Australia/Sydney","type":"text","title":"Understand It","locale":"en","wuid":"wuid:gx:7d5cfdd7f93f09f8","revision":17,"path":"/fignition/documentation/understand-it","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"understand-it","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":0,"onePickToken":"000770F20335E6EF051C2CF914E394B60B3579F06931BFA091::1562360812369","guest_":false,"displayNameOrEmail":"Steve Justin","userName":"stevejustin1963","uid":"12267405931756516888","domainUser":false,"renderMobile":false,"domain":null,"namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"stevejustin1963@gmail.com","hasAdminAccess":false},"gadgets":{"baseUri":"/site/libby8dev/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Understand It - Libby8dev" />
<meta itemprop="name" content="Understand It - Libby8dev" />
<meta property="og:title" content="Understand It - Libby8dev" />
<meta name="description" content="Open Development Site for A minimal Z80/Avr Single Board Computer" />
<meta itemprop="description" content="Open Development Site for A minimal Z80/Avr Single Board Computer" />
<meta id="meta-tag-description" property="og:description" content="Open Development Site for A minimal Z80/Avr Single Board Computer" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/4edc19/system/app/themes/tron/standard-css-tron-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/site/libby8dev/_/rsrc/1560928646000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/site/libby8dev/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Understand It - Libby8dev</title>
<meta itemprop="image" content="https://sites.google.com/site/libby8dev/_/rsrc/1352729195666/fignition/documentation/understand-it/FIGnitionAVRPinout.png?height=211&amp;width=320" />
<meta property="og:image" content="https://sites.google.com/site/libby8dev/_/rsrc/1352729195666/fignition/documentation/understand-it/FIGnitionAVRPinout.png?height=211&amp;width=320" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en_GB            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><h2><a href="https://sites.google.com/site/libby8dev/" dir="ltr" id="sites-chrome-userheader-title">Libby8dev</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/site/libby8dev/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList" class="has-expander"><li class="topLevel nav-first parent " wuid="gx:5e6ced805bd72d67"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="/site/libby8dev/home" jotId="wuid:gx:5e6ced805bd72d67" class="sites-navigation-link topLevel">Home</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/intro" jotId="wuid:gx:3c9f58ed9b65663" class="sites-navigation-link">Intro</a></div></li></ul></li><li class="topLevel parent " wuid="gx:73afab7deeb502b4"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="/site/libby8dev/fignition" jotId="wuid:gx:73afab7deeb502b4" class="sites-navigation-link topLevel">fignition</a></div><ul role="navigation" class="has-expander"><li class="parent " wuid="gx:7c694f1034e72915"><div dir="ltr" style="padding-left: 19px;"><div class="expander"></div><a href="/site/libby8dev/fignition/documentation" jotId="wuid:gx:7c694f1034e72915" class="sites-navigation-link">Documentation</a></div><ul role="navigation" class="has-expander"><li class="parent closed " wuid="gx:1f47cdb1dd9bbec2"><div dir="ltr" style="padding-left: 38px;"><div class="expander"></div><a href="/site/libby8dev/fignition/documentation/build-it-rev-d" jotId="wuid:gx:1f47cdb1dd9bbec2" class="sites-navigation-link">Build It (FIGnition 2011)</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/build-it-rev-d/build-it-2" jotId="wuid:gx:14c3a9f7c30cd42" class="sites-navigation-link">Build It(2)</a></div></li></ul></li><li class="parent closed " wuid="gx:4cc9ff0aae40ae78"><div dir="ltr" style="padding-left: 38px;"><div class="expander"></div><a href="/site/libby8dev/fignition/documentation/build-it" jotId="wuid:gx:4cc9ff0aae40ae78" class="sites-navigation-link">Build It (RevE)</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/build-it/test-it" jotId="wuid:gx:1168002fe978c699" class="sites-navigation-link">Testing The RevE Board</a></div></li></ul></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="/site/libby8dev/fignition/documentation/build-it-rev-d/fignition-flint" jotId="wuid:gx:2ad496bc723328a6" class="sites-navigation-link">FIGnition FLINT</a></div></li><li class=""><div dir="ltr" style="padding-left: 57px;"><a href="/site/libby8dev/fignition/documentation/use-it" jotId="wuid:gx:657697090bb7afcd" class="sites-navigation-link">Use It</a></div></li><li class="parent closed " wuid="gx:36d54917546b9d31"><div dir="ltr" style="padding-left: 38px;"><div class="expander"></div><a href="/site/libby8dev/fignition/documentation/code-it" jotId="wuid:gx:36d54917546b9d31" class="sites-navigation-link">Code It</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/built-in-definitions" jotId="wuid:gx:2cef875a512ee454" class="sites-navigation-link">Built-In Definitions</a></div></li><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/code-it/extra-definitions" jotId="wuid:gx:63fd970bbc0698d5" class="sites-navigation-link">Extra Definitions</a></div></li></ul></li><li class="parent " wuid="gx:7d5cfdd7f93f09f8"><div class="current-bg" jotId="wuid:gx:7d5cfdd7f93f09f8" dir="ltr" style="padding-left: 38px;"><div class="expander"></div>Understand It</div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/understand-it/video-modes" jotId="wuid:gx:57959a09321997e9" class="sites-navigation-link">Video Modes</a></div></li><li class=""><div dir="ltr" style="padding-left: 76px;"><a href="/site/libby8dev/fignition/documentation/understand-it/bytecodes" jotId="wuid:gx:74246869e26d7e79" class="sites-navigation-link">Forth Execution (Advanced Topic)</a></div></li></ul></li></ul></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/buy-it" jotId="wuid:gx:15500dbce4aeec91" class="sites-navigation-link">Buy It</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/publicity" jotId="wuid:gx:19f455ebfff1520f" class="sites-navigation-link">Publicity</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/progress" jotId="wuid:gx:3c3ad127e44a57a8" class="sites-navigation-link">Progress</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/schedule" jotId="wuid:gx:4aea2f3c7bdfcdb1" class="sites-navigation-link">Schedule</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/examples" jotId="wuid:gx:16cee0cd923b908e" class="sites-navigation-link">Examples</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/fignition/performance" jotId="wuid:gx:7b3d01b91149b658" class="sites-navigation-link">Performance</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/links-and-forums" jotId="wuid:gx:43a0fc94ca5c6178" class="sites-navigation-link">Links And Forums</a></div></li></ul></li><li class="topLevel parent " wuid="gx:402b72d856741da1"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="/site/libby8dev/figkeys" jotId="wuid:gx:402b72d856741da1" class="sites-navigation-link topLevel">FIGKeys</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/figkeys/build-it" jotId="wuid:gx:7dae51d88a06acae" class="sites-navigation-link">Build it</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/figkeys/test-it" jotId="wuid:gx:1fd9820c1b81e8c4" class="sites-navigation-link">Test it</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/figkeys/use-it" jotId="wuid:gx:5dcea6ac35829615" class="sites-navigation-link">Use It</a></div></li></ul></li><li class="topLevel parent " wuid="gx:182a07b96c6e5fe9"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="/site/libby8dev/libby8" jotId="wuid:gx:182a07b96c6e5fe9" class="sites-navigation-link topLevel">Libby8</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/libby8/concept" jotId="wuid:gx:2dbaf621339fd6b7" class="sites-navigation-link">Concept</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/libby8/circuit" jotId="wuid:gx:20b1edd6f9d5d20c" class="sites-navigation-link">Circuit</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/libby8/avr-firmware" jotId="wuid:gx:12fae2270b17f683" class="sites-navigation-link">Avr Firmware</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/libby8/emulator" jotId="wuid:gx:34df9cad3b1a3f87" class="sites-navigation-link">Emulator</a></div></li><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/libby8/faq" jotId="wuid:gx:6fff2256528722b9" class="sites-navigation-link">FAQ</a></div></li></ul></li><li class="topLevel parent " wuid="gx:55807cf0ff87fc50"><div dir="ltr" style="padding-left: 0px;"><div class="expander"></div><a href="/site/libby8dev/stripes" jotId="wuid:gx:55807cf0ff87fc50" class="sites-navigation-link topLevel">Stripes</a></div><ul role="navigation" class="has-expander"><li class=""><div dir="ltr" style="padding-left: 38px;"><a href="/site/libby8dev/stripes/examples" jotId="wuid:gx:1cbaaee17ab677d4" class="sites-navigation-link">Examples</a></div></li></ul></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="/site/libby8dev/ga" jotId="wuid:gx:7f040827d2115e7" class="sites-navigation-link topLevel">GALU - A Gate Array Logic based ALU IC.</a></div></li><li class="topLevel "><div dir="ltr" style="padding-left: 19px;"><a href="/site/libby8dev/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:50236f90e14b6ee4" class="sites-navigation-link topLevel">Sitemap</a></div></li></ul></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/site/libby8dev/fignition" dir="ltr">fignition</A>‎ &gt; ‎<A href="/site/libby8dev/fignition/documentation" dir="ltr">Documentation</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Understand It</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr">FIGnition is designed to be understandable. In time, this section will expand to cover:<br />
<br />
<ul><li>Understanding aspects of the Forth Language.</li>
<li>Understanding the FIGnition system.</li>
<li>Understanding the FIGnition firmware.</li>
<li>Understanding the FIGnition hardware.</li></ul>
<h3><a name="TOC-Understanding-Forth"></a>Understanding Forth</h3>
<h4><a name="the_stack">The Stack</a></h4>
No Forth user guide would be complete without an explanation of stacks....<br />
<br />
<h4><a name="TOC-Text-Processing"></a>Text Processing</h4>
FIG-Forth uses a number of ad-hoc methods for processing text: the Terminal Input Buffer; The PAD and the (for want of a better phrase) the <i>word</i> buffer. To understand them you'll need to know first how FIGnition organises its memory.<br />
<br />
<i>The Terminal Input Buffer (TIB)</i>. The Terminal Input Buffer is the primary text buffer in FIG-Forth and is returned by the command <b>tib</b>. Normally it starts at the address 0x8020 and has space for 128 characters. For example, the command <b>query</b> requests a line of text and stores it in the terminal input buffer, terminating it with a 0 character. The command <i>delimiter </i><b>word</b> reads text from the <i>TIB</i> until the specified delimiter is found and copies it into the <i>word</i> buffer (storing it as a length byte followed by the text itself). The command  <b>-find</b> reads the next space-delimited word from the tib into the <i>word</i> buffer and then searches the dictionary and if it finds a matching name returns its <i>parameter field address</i> (which can then be converted to its <i>code field address</i> using <b>pfa&gt;cfa</b> and executed).<br />
<br />
The TIB can be redirected to another area. For example, <b>load</b> reads a Flash block into high RAM and then redirects the TIB there, the interpreter then continues interpreting text from that buffer.<br />
<br />
<i>The PAD</i>. The PAD is used to convert numbers into text. It starts 68 bytes after the word buffer and works backwards. This is because the easiest way to convert numbers into text is via the least-significant digit first. Consider the number 987. If we divide by 10 we end up with 98 remainder 7 (a single digit). That's easy to convert into the character '7' and then we can do the same with 98 giving us 9 remainder 8 which we can convert to '8' and place infront of the '7' =&gt; '87'.<br />
<br />
<i>The 'word' buffer</i>. This is used for temporary text processing. In FIG-Forth it's set to the address of <i>here</i>.<br />
<h3><a name="TOC-Understanding-FIGnition"></a>Understanding FIGnition</h3>
<a name="pins"><h4><a name="TOC-FIGnition-s-Input-Output-Pins"></a>FIGnition's Input / Output Pins</h4></a>
<div style="display:block;text-align:left"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/FIGnitionAVRPinout.png?attredirects=0" imageanchor="1"><img border="0" height="211" src="https://sites.google.com/site/libby8dev/_/rsrc/1352729195666/fignition/documentation/understand-it/FIGnitionAVRPinout.png?height=211&amp;width=320" width="320" /></a></div>
<br />
<a name="memory"><h4><a name="TOC-FIGnition-s-Memory"></a>FIGnition's Memory<br />
</h4></a>
As standard FIGnition has 8Kb of external RAM (in chip U2) and 384Kb of Flash storage (in chip U3). Kb means 1024 bytes (see the <a href="http://simple.wikipedia.org/wiki/Byte" rel="nofollow">Simple English Wikipedia Entry</a>).<br />
<br />
Unlike people, who store vast quantities of memories without being aware of exactly which brain cell stores which part of a memory, a computer needs to know exactly where every byte of memory is and this is done by numbering them all like we number houses in a street or runners in a race or mobile phone numbers of our friends. FIGnition can specify up to 65536 different locations for bytes numbered from 0 to 65535 or 0 to 0xffff in hexadecimal notation. So you can think of FIGnition's memory as 65536 boxes each of which can contain a number from 0 to 255 and each of which is tagged with its location (called an address as in the address of a house), which is also a number from 0 to 65535.<br />
<br />
When FIGnition runs programs or when you use @, !, c@, c! or cmove the memory is organised as follows:<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/FIGnitionMemory.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1304589786485/fignition/documentation/understand-it/FIGnitionMemory.png?width=174" width="174" /></a></div>
<br />
So, the Forth ROM always starts at 0x6000 (24Kb) (there's room for 8Kb of ROM though &lt;4Kb is currently used) and RAM always starts at 0x8000 (32Kb).<br />
<br />
<b>Avr Memory.</b><br />
<br />
FIGnition is implemented using an AVR microcontroller which has its own memory: 1Kb of 
internal RAM; 16Kb of fast internal Flash memory; 1Kb of EEPROM 
memory and 32b of very fast memory called registers. AVR Microcontrollers don't organise their memory in one big chunk, but divide it into 'program' memory and 'data' memory. The AVR Firmware itself can be read by trying to read before or after the Forth ROM, but its starting location depends on the firmware revision itself. The AVR's data memory is organised as follows:<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/AvrDataMemory.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1304591308556/fignition/documentation/understand-it/AvrDataMemory.png?width=261" width="261" /></a></div>
<br />
At the moment only a few system variables are properly accessible, this will change in future firmware revisions. The Data stack and Return stack are held in internal memory for performance reasons, there are up to 256b shared between them. The AVR controller's hardware can be directly accessed via ic@, ic!, but much of it is used for implementing FIGnition. The EEPROM however is currently free for use, it provides 1Kb of non-volatile memory.<br />
<br />
<h4><a name="keypad">The Keypad</a></h4>
The Keypad uses 6 I/O pins to read 8 keys. They’re arranged as follows:<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/KeyPadHW01.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1309331012607/fignition/documentation/understand-it/KeyPadHW01.png" /></a></div>
<br />
You can see that if SW1 is pressed, there will be a connection between PortC&lt;0&gt; and PortD&lt;7&gt;; similarly if SW7, is pressed there will be a connection between PortC&lt;2&gt; and PortB&lt;0&gt;. For every switch there’s a unique connection between a PortC pin and either PortD&lt;7&gt; or PortB&lt;0&gt;.<br />
<br />
The firmware configures all of the PortC&lt;0&gt;..PortC&lt;3&gt; pins to activate their internal pull-up resistors, so normally all of these pins will read 1 (because they’re at a high voltage). To detect which keys have been pressed the firmware then configures PortB&lt;0&gt; and PortD&lt;7&gt; so that one of those pins are a normal input and the other outputs a 0.<br />
<br />
If PortD&lt;7&gt; outputs a 0, then, for example pressing SW1 will connect PortC&lt;0&gt; with 0V and will read low. However, if SW5 is also pressed PortC&lt;0&gt; will connect with PortB&lt;0&gt; (an input) and it won’t make any difference to PortC&lt;0&gt;. Therefore by setting PortD&lt;7&gt; to output 0, but leaving PortB&lt;0&gt; as an input we can read SW1 to SW4 and ignore SW5 to SW8.<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/KeyPadHW02.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1309331104124/fignition/documentation/understand-it/KeyPadHW02.png" /></a></div>
<br />
Reversing the configuration of PortD&lt;7&gt; and PortB&lt;0&gt; allows us to read SW5 to SW8 and ignore SW1 to SW4. Thus we can read the state of all 8 keys using only 6 input pins and importantly, no additional hardware.<br />
<br />
This system has one limitation when reading keys: if certain combinations of 3 keys are pressed, it will appear as though 4 keys are pressed. For example, if we press SW1, SW5 and SW3 it will look as though SW7 is also pressed. That’s because PortC&lt;2&gt; will connect to PortD&lt;7&gt;; PortD&lt;7&gt; will connect to PortC&lt;0&gt; and PortC&lt;0&gt; connects to PortB&lt;0&gt;. So, PortC&lt;2&gt; connects to PortB&lt;0&gt; and it looks like SW7 is being pressed.<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/KeyPadHW03.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1309331203961/fignition/documentation/understand-it/KeyPadHW03.png" /></a></div>
<br />
The second layer of keypad scanning involves key debouncing. At the speeds that the microcontroller runs, a keypress looks like a sequence of intermittent contacts before it settles down. The keypad code therefore doesn’t accept keys presses until they have settled, which is given to be about 2/25 of a second and it does this by simply comparing the previous keypad reading with the current one and if they’re the same, then it’s said to be settled.<br />
<br />
<div style="display:block;text-align:center;margin-right:auto;margin-left:auto"><a href="https://sites.google.com/site/libby8dev/fignition/documentation/understand-it/KeyPadHW04.png?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/site/libby8dev/_/rsrc/1309331272044/fignition/documentation/understand-it/KeyPadHW04.png" /></a></div>
Real keyboards for modern computers work in a very similar way; they usually use a matrix of simple connections and the keyboard’s firmware eliminates debounce.<br />
<br />
The FIGnition keypad scanner has a third layer for reading keys, because of the complexity of having every key acting as a shfit key for any of the others. It does this by monitoring which key was pressed first and when two keys are pressed.<br />
<br />
<a name="spi">
<h3><a name="TOC-SPI-Driver"></a>SPI Driver</h3>
</a>
Firmware Rev0.8.0 and later includes a rudimentary SPI driver. The key difficulty with supporting SPI peripherals on FIGnition is that SRAM is also an SPI device, so an entire SPI transaction must be carried out between successive SRAM instructions. The SPI driver does this by specifying the SPI transaction within a struct:<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>typedef struct {</code><br />
<code>
    byte port;</code><br />
<code>
    byte portBit;</code><br />
<code>
    tBigEndianWord src;</code><br />
<code>
    tBigEndianWord srcLen;</code><br />
<code>
    tBigEndianWord dst;</code><br />
<code>
    tBigEndianWord dstLen;</code><br />
<code>
} tSpiStruct;</code></div>
<br />
<br />
And expects the struct, its source and destination data to all be in internal RAM.<br />
<br />
The command <b>spi</b> expects a pointer to the SpiStruct to be on the stack. The first byte specifies <i>port</i> (its RAM address) and <i>portBit</i> (actually 1&lt;&lt;the actual bit number) used to connect to the SPI device, <i>src</i> points to the source data to be sent to the SPI device (which must also be in internal RAM), <i>srcLen</i> specifies its length. <i>dst</i> specifies where to store the result data from the SPI device, it must also point to internal RAM and must be <i>dstLen</i> bytes long.<br />
<br />
spi pulls Port&lt;1&lt;&lt;portBit&gt; low, then sends <i>srcLen</i> bytes starting at <i>src</i> to the SPI device, then sends <i>dstLen</i> bytes of 0 to the SPI device reading each byte returned and storing it in <i>dstLen</i>. Thus <b>spi</b> can cope with any SPI device whose protocol is that simple. For example, the Amic Flash device is simple enough to be covered by <b>spi</b>.<br />
<br />
Here's a short example. Let's say you want to read the ID of the Amic Flash. The flash is on PORTB ( 0x26) portBit 2. So port=0x26 (=38) and portBit = 1 2 &lt;&lt; .<br />
<br />
The Read ID command (RDID) is 0x9f. The protocol is a 1 byte command so <i>srcLen</i>=1. For some of the Flash devices it'll be 0x7f, then 0x37, then a 2 byte ID and for others it'll be 0x37, then a 2 byte ID. So, first we just send the command and read 1 byte back, test it for 0x7f and if it is we retry with 4 bytes else we retry with 3 bytes. We'll put the entire structure and return data in udg0 onwards. First the definition:<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>: cdata &lt;builds does&gt; ;</code><br />
<br />
<code>vram 600 + const udg0</code><br />
<code>cdata AmicRdidData 38 c, 1 2 &lt;&lt; c, ( port and port bit mask)</code><br />
<code>    udg0 10 + , ( src addr )</code><br />
<code>    1 ,</code><br />
<code>    udg0 11 + , (dst addr )</code><br />
<code>     1 ,</code><br />
<code>     hex 9f decimal ( rdid )</code><br />
<br />
<code>: AmicRdid</code><br />
<code>   AmicRdidData udg0 11 cmove</code><code> ( store data in internal RAM)</code><br />
<code>   udg0 spi ( start the SPI operation)</code><br />
<code>   udg0 11 + ic@ 127 = if</code><br />
<code>        14 4 ( rdid is 4 bytes with the id at offset 14 )</code><br />
<code>   else</code><br />
<code>      13 3 ( rdid is 3 bytes with the id at offset 13 )</code><br />
<code>    </code><code>then</code><br />
<code>   udg 8 + i! ( store the new length )</code><br />
<code>   udg0 spi ( retry but with the correct length)</code><br />
<code>   udg0 + i@ .hex</code><br />
<code>;</code></div>
<br />
<br />
So, here we have a fairly complex routine, but it can be handled by our SPI driver.<br />
<br />
<a name="atomic">
<h3><a name="TOC-Atomic-Port-Access"></a>Atomic Port Access</h3>
</a>
FIGnition provides a comprehensive routine for both modifying ports atomically and reading them, called <b>&gt;port&gt;</b>. A number of FIGnition's I/O ports are used by FIGnition's interrupt routines, they read, modify and write them. If your normal code does the same thing it could crash FIGnition if your code is interrupted. Consider this:<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>hex 2b decimal const portD</code><br />
<code>hex 2a decimal const dddD</code><br />
<code>hex 29 decimal const pinD</code><br />
<br />
<code>: bit&gt; 1 swap &lt;&lt; ;</code><br />
<br />
<code>: mess</code><br />
<code>   dddD ic@ 6 bit&gt; or dddD ic! ( make bit 6 output )</code><br />
<code>   begin portD ic@ 6 bit&gt; xor portD ic! ( toggle bit 6) inkey emit</code><br />
<code>   again</code><br />
<code>;</code></div>
<br />
<br />
This will cause the keyboard to fail some of the time, because the following will happen:<br />
<br />
<code>dddD ic@</code><br />
<i>Somewhere here the keyboard interrupt will run and modify dddD</i><br />
<code>6 bit&gt; dddD ic!</code><br />
<i>Which writes the old version of dddD before the keyboard interrupt modified it</i>.<br />
<br />
Doing similar things with different ports will quicly cause crashes. The standard way to handle this at the lowest level in embedded (and mobile device) systems is to provide a read-modify-write routine which operates while interrupts are disabled. The rmw routine is short enough ( &lt;1µs) so that it doesn't mess up critical interrupts. In the case of <b>&gt;port&gt;</b> interrupts are disabled for about 0.25µs.<br />
<br />
What you do is provide the bitset of bits you want to clear and the bits you want to set, then <i>orMask andMask </i><b>&gt;port&gt;</b> reads the port, clears the bits that are set to 0 in the <i>andMask</i> and then sets the bits that are set to 0 in <i>orMask</i>. You can use this to safely modify a single bit:<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>: notmess</code><br />
<span><code> </code></span><code>  6 bit&gt; -1 dddD &gt;port&gt; drop ( clear nothing, set bit 6 to make it an output )</code><br />
<code>   0 ( toggle value )</code><br />
<span><code>   </code></span><code>begin </code><br />
<code>   dup dup -1 xor portD &gt;port&gt; drop ( toggle the output )</code><br />
<code>   6 bit&gt; xor ( invert the toggle value )</code><br />
<code>   inkey emit</code><br />
<code>   again</code><br />
<code>;</code></div>
<br />
<br />
Which safely modifies the port (note: I haven't yet tested the <b>notmess</b> and <b>mess</b> routines, but the theory is correct).<br />
<br />
<b>&gt;port&gt;</b> has the interesting feature that it returns the old value of the port. Thus it can be used to implement basic, shared memory routines, preparing the way for when FIGnition's firmware supports a form of multitasking. Here we'd do something like:<br />
<br />
<div class="sites-codeblock sites-codesnippet-block"><code>hex 4b decimal gpior2</code><br />
<br />
<code>: waitLockInit ( called globally, once)</code><br />
<code>  0 gpior2 ic!</code><br />
<code>;</code><br />
<br />
<code>: release ( accessBit -- )</code><br />
<code>  bit&gt; -1 xor 0 swap gpior2 &gt;port&gt; ( clear the accessBit )</code><br />
<code>  drop</code><br />
<code>;</code><br />
<br />
<code>: waitLock ( accessBit -- )</code><br />
<code>  bit&gt;</code><br />
<code>  begin</code><br />
<code>  dup 0 gpior2 &gt;port&gt;</code><br />
<code>  0= until ( waits until gpior2 was released )</code><br />
<code>  drop</code><br />
<code>;</code></div>
<br />
<br />
Here multiple tasks can compete for shared memory locations using bits in gpior2 as spin-locks. <b>waitLock</b> competes for access and only one of them will find that the bit had been 0 before their <b>waitLock</b> sets it (note: it's not harmful to set the bit if it's already set). Thus <b>&gt;port&gt;</b> is all you need!<br />
<br />
<br /></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages" class="sites-canvas-bottom-panel-wrapper" style="">
<div class="sites-subpages">
            Subpages <span id="subpages-total-number">(2):</span>
<span>
<a href="/site/libby8dev/fignition/documentation/understand-it/bytecodes" dir="ltr">Forth Execution (Advanced Topic)</a>
</span>
<span>
<a href="/site/libby8dev/fignition/documentation/understand-it/video-modes" dir="ltr">Video Modes</a>
</span>
</div>
</div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://accounts.google.com/AddSession?continue=https://sites.google.com/site/libby8dev/fignition/documentation/understand-it&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/site/libby8dev/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="https://sites.google.com/site/libby8dev/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com/site">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/4edc19/system/js/jot_min_view__en_gb.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/site/libby8dev/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/u/0/d/AAHRpnXsPxZjbAZh3TEOF-thhM7zMcxeaMaSk6GP8gH-DLFn73K-XdERLUhFz5GfgzqZk_DzX8pjw5SW1OhV4NGgU8-UdNDnuoNreWYeHtD1VYVuoYF9npi6kH-8QrL9FXZFg8UYMCoTO/api/js?token=AGNctVYHGFlRcV098Bx_p7irsRNSuV-bIw:1562360812488',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en_GB");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<script type="text/javascript">
          sites.codeembed.init();
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
